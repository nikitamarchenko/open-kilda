@startuml

title Sample of Domain Model with DataMapper pattern

actor FL

box "Domain Model Layer" #LightBlue
	participant SwitchTopology
	participant Switch

end box

box "Database Layer" #LightGreen
	participant SwitchDataMapper
	participant DB
end box

== Create Switch ==

FL -> SwitchTopology : switch added
activate SwitchTopology
create Switch
SwitchTopology -> Switch : create Switch
SwitchTopology <- Switch


SwitchTopology -> SwitchDataMapper : save(Switch)
activate SwitchDataMapper
SwitchDataMapper -> DB : create entity in DB
SwitchDataMapper <- DB
SwitchTopology <- SwitchDataMapper
deactivate SwitchDataMapper
deactivate SwitchTopology


== Update Switch ==

FL -> SwitchTopology : switch changed
activate SwitchTopology

SwitchTopology -> SwitchDataMapper : getSwitchById
activate SwitchDataMapper
SwitchDataMapper -> DB : get entity from DB
SwitchDataMapper <- DB
SwitchDataMapper -> SwitchDataMapper: Map data from DB to Domain Object
SwitchTopology <- SwitchDataMapper : return Switch
deactivate SwitchDataMapper
SwitchTopology -> SwitchTopology : update Switch state

SwitchTopology -> SwitchDataMapper : save(Switch)
activate SwitchDataMapper
SwitchDataMapper -> DB : update entity in DB
SwitchDataMapper <- DB
SwitchTopology <- SwitchDataMapper
deactivate SwitchDataMapper
deactivate SwitchTopology


@enduml